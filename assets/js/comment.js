(()=>{const e=document.querySelector("#commentForm"),t=document.querySelector("#videoContainer"),n=document.querySelector(".video__comments");e&&e.addEventListener("submit",(async n=>{const o=e.querySelector("textarea"),c=o.value;n.preventDefault();const d=t.dataset.id;if(!c)return;const s=await fetch(`/api/videos/${d}/comment`,{method:"POST",body:JSON.stringify({text:c}),headers:{"Content-Type":"application/json"}});if(o.value="",201===s.status){const{id:e,owner:t}=await s.json();a(c,e,t)}}));const a=(e,t,n)=>{const a=document.querySelector(".video__comments"),o=document.createElement("li"),c=document.createElement("i"),d=document.createElement("span"),s=document.createElement("button");o.className="video__comment",c.className="fas fa-comment",s.className="comment__delete",d.innerText=` ${e}`,s.innerText=" ❌",o.appendChild(c),o.appendChild(d),o.appendChild(s),a.prepend(o),o.dataset.id=t,c.dataset.id=n};n.addEventListener("click",(async t=>{if("button"===t.target.localName){const n=t.target.parentElement,a=n.querySelector("i"),o=n.dataset.id;await fetch(`/api/comments/${o}`,{method:"DELETE"});const c=a.dataset.id;e.dataset.user===c&&n.remove()}}))})();